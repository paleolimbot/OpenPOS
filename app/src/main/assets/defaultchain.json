{
  "type": "switch",
  "is_regex": true,
  "key": "gtin13",
  "values": ["^97.*?$", "^.*?$"],
  "actions": [
    {
      "type": "chain",
      "name": "ISBN Chain",
      "actions": [
        {
          "type": "lookup",
          "name": "isbndb",
          "encoding": "windows-1251",
          "mime_type": "application/json",
          "uri_format": "http://isbndb.com/api/v2/json/T89SFTZN/book/{{isbn13}}",
          "key_map": {
            "data[0]/title": "title",
            "data[0]/author_data[; ]/name": "authors",
            "data[0]/dewey_normal": "dewey_normal",
            "data[0]/lcc_number": "lcc_number",
            "data[0]/publisher_text": "publisher"
          }
        },
        {
          "type": "stringformat",
          "key_map": {
            "amazon_search": "https://www.amazon.com/s/field-keywords={{isbn13}}",
            "_description": "{{title}} ({{authors}}"
          }
        }
      ]
    },
    {
      "type": "lookup",
      "name": "upc",
      "uri_format": "https://www.upcdatabase.com/xmlrpc",
      "request": "<?xml version=\"1.0\"?><methodCall><methodName>lookup</methodName><params><param><value><struct><member><name>rpc_key</name><value>d59fa84ebe4aad99c691b287907d736d34fb5d5a</value></member><member><name>ean</name><value>{{gtin13}}</value></member></struct></value></param></params></methodCall>",
      "mime_type": "text/xml-rpc",
      "api_type": "XML-RPC",
      "key_map": {
        "message": "upc_status",
        "description": "_description",
        "size": "size"
      }
    }
  ]
}